================================================================================
                    要件定義書
           3-2-1-1-0バックアップ管理システム
================================================================================

文書番号: RD-BACKUP-MGMT-001
版番号: 1.0
作成日: 2025年10月28日
承認者: [承認者名]
作成者: システム開発チーム

================================================================================
目次
================================================================================

1. プロジェクト概要
2. ビジネス要件
3. 機能要件
4. 非機能要件
5. セキュリティ要件 (ISO 27001準拠)
6. 情報管理要件 (ISO 19650準拠)
7. システム制約条件
8. コンプライアンス要件
9. 前提条件と依存関係
10. リスクと課題

================================================================================
1. プロジェクト概要
================================================================================

1.1 背景と目的
--------------

【背景】
近年のランサムウェア攻撃の増加により、従来の3-2-1バックアップルールだけ
では不十分となっている。オフライン/エアギャップバックアップと定期的な検証
を含む3-2-1-1-0ルールの適用が業界標準となりつつある。

本システムは、企業のバックアップ運用を3-2-1-1-0ルールに準拠させ、その
状態を可視化・管理することで、データ損失リスクを最小化することを目的とする。

【目的】
- 3-2-1-1-0ルール準拠状況の可視化
- バックアップジョブの一元管理
- オフラインメディアの追跡管理
- 検証テストの自動化とレポート作成
- ISO 27001、ISO 19650への準拠支援
- 監査対応の効率化

1.2 適用範囲
------------

【対象環境】
- Windows 11 Enterprise (本番環境)
- Linux (Ubuntu 22.04/24.04 LTS) (開発環境)
- Windows Server 2019/2022 (バックアップ対象サーバー)

【対象システム】
- Veeam Backup & Replication
- Windows Server Backup
- AOMEI Backupper
- カスタムバックアップスクリプト (PowerShell)

【対象データ】
- サーバーシステムイメージ
- ファイルサーバーデータ
- データベースバックアップ
- 仮想マシンスナップショット
- BIM/CADデータ (ISO 19650対象)

1.3 用語定義
------------

3-2-1ルール     : データのコピーを3つ、2種類のメディア、1つはオフサイト
3-2-1-1-0ルール : 上記に加え、1つはオフライン、0エラー(検証済み)
エアギャップ    : ネットワークから物理的/論理的に切り離された状態
オフサイト      : 本番環境とは別の物理的な場所
イミュータブル  : 書き換え不可能な状態
CDE             : Common Data Environment (共通データ環境)

1.4 関係者
----------

【ステークホルダー】
- ITシステム運用管理者: システム全体の運用管理責任者
- バックアップ管理者: 日次バックアップ運用担当者
- 情報セキュリティ管理者: ISO 27001準拠確認
- BIM/CIMマネージャー: ISO 19650準拠確認 (建設・土木環境)
- 監査担当者: 内部監査・外部監査対応
- 経営層: コンプライアンスレポート確認

================================================================================
2. ビジネス要件
================================================================================

2.1 ビジネスゴール
------------------

BR-001: ランサムウェア攻撃からのデータ保護
  優先度: 高
  説明: オフライン/エアギャップバックアップにより、攻撃を受けても
        データ復旧が可能な体制を構築する

BR-002: バックアップ運用コストの削減
  優先度: 中
  説明: 手動管理作業を自動化し、運用工数を30%削減する

BR-003: 監査対応時間の短縮
  優先度: 高
  説明: コンプライアンスレポートの自動生成により、監査準備時間を
        50%短縮する

BR-004: データ損失ゼロの実現
  優先度: 高
  説明: RPO (Recovery Point Objective) 24時間以内、
        RTO (Recovery Time Objective) 4時間以内を達成する

BR-005: ISO認証維持の効率化
  優先度: 高
  説明: ISO 27001、ISO 19650の要求事項への準拠を証明する
        エビデンスを自動生成する

2.2 成功指標 (KPI)
------------------

- バックアップ成功率: 99.9%以上
- 3-2-1-1-0ルール準拠率: 100%
- 復元テスト成功率: 100%
- 平均復旧時間 (RTO): 4時間以内
- 目標復旧時点 (RPO): 24時間以内
- 監査準備時間: 従来比50%削減
- オフラインメディア更新遅延: 0件

================================================================================
3. 機能要件
================================================================================

3.1 バックアップジョブ管理機能
------------------------------

FR-001: バックアップジョブ登録
  優先度: 高
  説明: バックアップジョブの基本情報を登録する
  入力項目:
    - ジョブ名 (必須、最大100文字)
    - ジョブ種別 (システムイメージ/ファイル/データベース/VM)
    - 対象サーバー/パス
    - バックアップツール (Veeam/WSB/AOMEI/カスタム)
    - スケジュール (日次/週次/月次/手動)
    - 保持期間 (日数)
    - 担当者
    - 説明 (任意、最大500文字)
  処理:
    - 入力値の妥当性検証
    - データベースへの登録
    - 監査ログ記録
  出力:
    - 登録完了メッセージ
    - ジョブID自動採番

FR-002: バックアップコピー管理
  優先度: 高
  説明: 1つのジョブに対する複数のコピーを管理する
  入力項目:
    - コピー種別 (プライマリ/セカンダリ/オフサイト/オフライン)
    - メディアタイプ (ディスク/テープ/クラウド/外付けHDD)
    - 保存先パス/URL
    - 暗号化有無
    - 圧縮有無
    - 最終更新日時
  処理:
    - 3-2-1-1-0ルール準拠状況の自動チェック
    - 不足しているコピー種別の警告
  出力:
    - 準拠状況表示
    - 警告メッセージ

FR-003: バックアップステータス更新
  優先度: 高
  説明: PowerShellスクリプトからREST API経由でステータスを更新
  入力項目 (JSON):
    - ジョブID
    - 実行日時
    - 実行結果 (成功/失敗/警告)
    - エラーメッセージ (失敗時)
    - バックアップサイズ (バイト)
    - 所要時間 (秒)
  処理:
    - API認証トークン検証
    - ジョブ存在確認
    - ステータス更新
    - アラート判定
  出力:
    - HTTP 200 (成功) / 400 (不正リクエスト) / 401 (認証エラー)

FR-004: バックアップジョブ検索
  優先度: 中
  説明: 条件を指定してジョブを検索する
  検索条件:
    - ジョブ名 (部分一致)
    - ジョブ種別
    - 担当者
    - ステータス (準拠/非準拠/警告)
    - 最終実行日範囲
  出力:
    - 検索結果一覧 (ページネーション対応)
    - 件数表示

3.2 3-2-1-1-0ルール準拠チェック機能
-----------------------------------

FR-010: リアルタイム準拠状況表示
  優先度: 高
  説明: ダッシュボードに準拠状況をリアルタイム表示
  表示項目:
    - 総ジョブ数
    - 準拠ジョブ数/率
    - 非準拠ジョブ数/率
    - 警告ジョブ数/率
    - ルール別準拠状況:
      - コピー数3つ以上: ○/×
      - メディア種別2種類以上: ○/×
      - オフサイト保管1つ以上: ○/×
      - オフライン保管1つ以上: ○/×
      - 検証エラー0: ○/×
  更新頻度: リアルタイム (WebSocket/ポーリング)

FR-011: 自動アラート生成
  優先度: 高
  説明: ルール非準拠を検知し自動アラート
  トリガー条件:
    - コピー数不足
    - メディア種別が1種類のみ
    - オフサイト保管なし
    - オフライン保管なし
    - オフラインメディア更新遅延 (7日以上)
    - 検証エラー発生
    - バックアップ失敗
  処理:
    - アラートレベル判定 (警告/エラー/致命的)
    - 通知先判定 (担当者/管理者/全体)
    - 通知実行 (メール/Teams/ダッシュボード表示)
  出力:
    - 通知メッセージ
    - アラートログ記録

FR-012: 準拠状況レポート生成
  優先度: 中
  説明: 定期的な準拠状況レポートを自動生成
  レポート種別:
    - 日次サマリー
    - 週次詳細レポート
    - 月次コンプライアンスレポート
    - 監査用エビデンスレポート
  出力形式: HTML / PDF / CSV
  配信方法: メール自動送信 / ダウンロード

3.3 オフラインメディア追跡機能
------------------------------

FR-020: オフラインメディア登録
  優先度: 高
  説明: 物理的なオフラインメディアを登録・管理
  入力項目:
    - メディアID (バーコード/シリアル番号)
    - メディア種別 (外付けHDD/テープ/USB)
    - 容量
    - 購入日
    - 保管場所 (金庫/別拠点/外部倉庫)
    - 現在の状態 (使用中/保管中/退役)
    - 担当者
  処理:
    - QRコード生成
    - メディアラベル印刷用データ出力
  出力:
    - メディアID自動採番
    - QRコードイメージ

FR-021: オフラインメディアローテーション管理
  優先度: 高
  説明: ローテーションスケジュールを管理
  入力項目:
    - ローテーション方式 (GFS/Tower of Hanoi/カスタム)
    - ローテーション周期 (週次/月次)
    - 対象メディアリスト
    - 次回入れ替え予定日
  処理:
    - 入れ替え期日の自動計算
    - 期日7日前アラート
    - 期日超過時エスカレーション
  出力:
    - ローテーションスケジュール表
    - 入れ替え対象メディア通知

FR-022: メディア貸出/返却管理
  優先度: 中
  説明: オフラインメディアの貸出・返却を記録
  入力項目 (貸出時):
    - メディアID
    - 貸出先 (担当者/部署/外部)
    - 貸出目的
    - 貸出日
    - 返却予定日
  入力項目 (返却時):
    - メディアID
    - 返却日
    - 状態確認 (正常/異常)
    - 備考
  処理:
    - 返却遅延チェック
    - メディア状態更新
    - 履歴記録
  出力:
    - 貸出証明書
    - 返却確認書

3.4 検証テスト管理機能
----------------------

FR-030: リストアテスト実行登録
  優先度: 高
  説明: 定期的なリストアテストを記録
  入力項目:
    - バックアップジョブID
    - テスト種別 (完全復元/部分復元/整合性チェック)
    - テスト実施日時
    - テスト実施者
    - リストア先 (本番/テスト環境)
    - テスト結果 (成功/失敗)
    - 所要時間
    - 検証項目チェックリスト
    - 備考
  処理:
    - テスト結果の検証
    - 失敗時のエスカレーション
    - 統計データ更新
  出力:
    - テスト完了レポート
    - 問題点サマリー

FR-031: テストスケジュール管理
  優先度: 高
  説明: リストアテストのスケジュールを管理
  入力項目:
    - バックアップジョブID
    - テスト頻度 (月次/四半期/半期/年次)
    - 次回テスト予定日
    - 担当者
  処理:
    - 次回テスト日の自動計算
    - テスト日7日前リマインダー
    - 未実施時のエスカレーション
  出力:
    - テストスケジュール一覧
    - リマインダー通知

FR-032: 検証エラー追跡
  優先度: 高
  説明: 検証エラーを記録し、解決まで追跡
  入力項目:
    - エラーID (自動採番)
    - バックアップジョブID
    - エラー種別 (データ破損/容量不足/接続エラー等)
    - エラー詳細
    - 発見日時
    - 重要度 (低/中/高/致命的)
    - 対応状況 (未対応/対応中/完了)
    - 担当者
  処理:
    - エラー集計
    - SLA違反チェック
    - エスカレーション
  出力:
    - エラー一覧
    - 未解決エラー警告

3.5 レポート・ダッシュボード機能
--------------------------------

FR-040: リアルタイムダッシュボード
  優先度: 高
  説明: システム全体の状況を可視化
  表示項目:
    - 3-2-1-1-0ルール準拠率 (円グラフ)
    - 直近7日間のバックアップ成功率 (折れ線グラフ)
    - ストレージ使用率 (棒グラフ)
    - アラート一覧 (表形式)
    - 次回実行予定ジョブ (表形式)
    - オフラインメディア状態サマリー
  更新頻度: 5分毎

FR-041: コンプライアンスレポート
  優先度: 高
  説明: ISO 27001/19650監査用レポート生成
  レポート項目:
    - 期間中のバックアップ実績
    - ルール準拠状況推移
    - インシデント発生件数と対応
    - リストアテスト実施状況
    - オフラインメディア管理状況
    - セキュリティイベントログ
    - 変更管理履歴
  出力形式: PDF (電子署名付き)
  生成タイミング: 月次自動 / オンデマンド

FR-042: 運用レポート
  優先度: 中
  説明: 日次・週次の運用レポート
  レポート項目:
    - 実行ジョブ一覧
    - 成功/失敗/警告件数
    - エラー詳細
    - ストレージ使用量
    - 所要時間統計
  配信先: 運用担当者
  配信タイミング: 毎朝8:00

3.6 REST API機能
----------------

FR-050: バックアップステータス更新API
  優先度: 高
  エンドポイント: POST /api/v1/backup/status
  認証: Bearer Token
  リクエスト形式: JSON
  レスポンス形式: JSON

FR-051: ジョブ情報取得API
  優先度: 高
  エンドポイント: GET /api/v1/jobs/{job_id}
  認証: Bearer Token
  レスポンス形式: JSON

FR-052: アラート取得API
  優先度: 中
  エンドポイント: GET /api/v1/alerts
  認証: Bearer Token
  クエリパラメータ: status, severity, date_from, date_to
  レスポンス形式: JSON

FR-053: レポート生成API
  優先度: 中
  エンドポイント: POST /api/v1/reports/generate
  認証: Bearer Token
  リクエストパラメータ: report_type, date_from, date_to
  レスポンス形式: JSON (レポートURL返却)

3.7 通知機能
------------

FR-060: メール通知
  優先度: 高
  トリガー:
    - バックアップ失敗
    - ルール非準拠検知
    - オフラインメディア更新遅延
    - リストアテスト失敗
  通知内容:
    - 件名、本文 (テンプレート化)
    - 関連リンク (詳細画面へのURL)
    - 推奨アクション
  設定項目:
    - SMTPサーバー設定
    - 送信元アドレス
    - 通知先グループ管理

FR-061: Microsoft Teams通知
  優先度: 中
  トリガー: メール通知と同様
  通知方式: Incoming Webhook
  通知内容: Adaptive Card形式

3.8 ユーザー管理・認証機能
--------------------------

FR-070: ユーザー登録・管理
  優先度: 高
  入力項目:
    - ユーザーID
    - ユーザー名
    - メールアドレス
    - 所属部署
    - 役割 (管理者/運用者/閲覧者)
    - 有効/無効フラグ
  処理:
    - パスワードハッシュ化保存
    - 役割ベースアクセス制御 (RBAC)
  出力:
    - ユーザー一覧

FR-071: ログイン認証
  優先度: 高
  認証方式:
    - ローカル認証 (ユーザーID + パスワード)
    - Active Directory統合 (LDAP/Kerberos) ※将来対応
  セキュリティ対策:
    - パスワード複雑性要件
    - ログイン試行回数制限 (5回)
    - アカウントロックアウト (10分間)
    - セッションタイムアウト (30分)

FR-072: 役割ベースアクセス制御
  優先度: 高
  役割定義:
    - システム管理者: 全機能へのアクセス、ユーザー管理
    - バックアップ管理者: バックアップ運用、レポート閲覧
    - 閲覧者: ダッシュボード・レポート閲覧のみ
    - 監査担当者: レポート・ログ閲覧のみ

3.9 監査ログ機能
----------------

FR-080: 操作ログ記録
  優先度: 高
  記録対象:
    - ユーザーログイン/ログアウト
    - バックアップジョブ登録/更新/削除
    - 設定変更
    - レポート生成
    - API呼び出し
  記録項目:
    - 日時
    - ユーザーID
    - IPアドレス
    - 操作内容
    - 対象リソース
    - 操作結果 (成功/失敗)
  保存期間: 3年間

FR-081: セキュリティイベントログ
  優先度: 高
  記録対象:
    - ログイン失敗
    - 不正アクセス試行
    - 権限外アクセス試行
    - パスワード変更
    - データ削除
  処理:
    - 閾値超過時の自動アラート
    - セキュリティ管理者への通知

FR-082: 監査ログ検索・エクスポート
  優先度: 中
  検索条件:
    - 日時範囲
    - ユーザー
    - 操作種別
    - 結果
  エクスポート形式: CSV / JSON
  用途: 監査証跡提出

================================================================================
4. 非機能要件
================================================================================

4.1 性能要件
------------

NFR-001: レスポンス時間
  - ダッシュボード表示: 3秒以内
  - ジョブ検索: 5秒以内 (1000件以下)
  - API応答: 1秒以内
  - レポート生成: 30秒以内 (月次レポート)

NFR-002: 同時接続ユーザー数
  - 最大同時接続: 50ユーザー
  - 通常運用想定: 10ユーザー

NFR-003: データベース容量
  - 初期想定: 10GB
  - 3年間運用想定: 50GB
  - バックアップジョブ数: 最大500ジョブ

NFR-004: API呼び出し頻度
  - PowerShellからのステータス更新: 最大100回/時間
  - レート制限: 1000リクエスト/時間/IPアドレス

4.2 可用性要件
--------------

NFR-010: システム稼働率
  - 稼働率目標: 99.5% (営業時間内)
  - 計画停止: 月次メンテナンス (第2土曜日 2:00-4:00)

NFR-011: バックアップ
  - システムデータベースの日次バックアップ
  - バックアップ世代管理: 7世代
  - 復旧目標時間 (RTO): 2時間以内

NFR-012: 障害復旧
  - データベース破損時の復旧手順書整備
  - 年次復旧訓練の実施

4.3 拡張性要件
--------------

NFR-020: スケーラビリティ
  - バックアップジョブ数: 500 → 2000へ拡張可能
  - ユーザー数: 50 → 200へ拡張可能
  - ストレージ: SQLite → PostgreSQLへ移行可能

NFR-021: 機能拡張性
  - プラグインアーキテクチャ (バックアップツール追加)
  - REST API拡張
  - 通知チャネル追加 (Slack等)

4.4 保守性要件
--------------

NFR-030: ログ出力
  - アプリケーションログ: 日次ローテーション
  - エラーログ: 即時記録
  - ログ保存期間: 90日間

NFR-031: 監視
  - プロセス監視
  - ディスク使用率監視
  - CPU/メモリ使用率監視
  - 監視ツール: Windows Performance Monitor / Prometheus (将来)

NFR-032: 変更管理
  - バージョン管理: Git
  - 変更履歴の記録
  - ロールバック手順の整備

4.5 移植性要件
--------------

NFR-040: クロスプラットフォーム対応
  - 開発環境: Linux (Ubuntu 22.04/24.04 LTS)
  - 本番環境: Windows 11 Enterprise
  - パス処理: pathlib使用で統一
  - 環境変数による設定分離

NFR-041: ブラウザ対応
  - Google Chrome (最新版)
  - Microsoft Edge (最新版)
  - Firefox (最新版)
  - レスポンシブデザイン対応

4.6 ユーザビリティ要件
----------------------

NFR-050: UI/UX
  - 日本語UI
  - 直感的な操作性
  - ヘルプ機能
  - エラーメッセージの明確化

NFR-051: アクセシビリティ
  - WCAG 2.1 レベルA準拠
  - キーボード操作対応
  - スクリーンリーダー対応

NFR-052: マニュアル
  - ユーザーマニュアル (PDF/HTML)
  - システム管理者マニュアル
  - API仕様書

================================================================================
5. セキュリティ要件 (ISO 27001準拠)
================================================================================

5.1 アクセス制御 (ISO 27001 A.9)
--------------------------------

SEC-001: 認証
  - 強固なパスワードポリシー (最低8文字、英数字記号混在)
  - パスワード有効期限: 90日
  - 多要素認証 (MFA) ※将来対応
  - Active Directory統合 ※将来対応

SEC-002: 認可
  - 役割ベースアクセス制御 (RBAC)
  - 最小権限の原則
  - 職務分掌の実施

SEC-003: セッション管理
  - セッションタイムアウト: 30分
  - セキュアクッキー使用
  - CSRF対策トークン

5.2 暗号化 (ISO 27001 A.10)
---------------------------

SEC-010: 通信の暗号化
  - HTTPS (TLS 1.2以上) 必須
  - 自己署名証明書不可 (本番環境)
  - API通信の暗号化

SEC-011: データの暗号化
  - パスワードのハッシュ化 (bcrypt/Argon2)
  - 機密情報のデータベース暗号化
  - APIトークンの暗号化保存

SEC-012: 鍵管理
  - 暗号鍵のセキュアな保管
  - 定期的な鍵ローテーション (年次)
  - 鍵へのアクセス制限

5.3 物理的セキュリティ (ISO 27001 A.11)
----------------------------------------

SEC-020: オフラインメディア保管
  - 物理的な金庫保管
  - アクセス記録の保持
  - 保管場所の環境管理 (温湿度)

5.4 運用セキュリティ (ISO 27001 A.12)
--------------------------------------

SEC-030: 変更管理
  - 変更申請・承認プロセス
  - テスト環境での事前検証
  - ロールバック計画

SEC-031: バックアップ (ISO 27001 A.12.3)
  - システムデータベースの日次バックアップ
  - バックアップの暗号化
  - リストアテストの定期実施

SEC-032: ログとモニタリング (ISO 27001 A.12.4)
  - 操作ログの記録
  - セキュリティイベントの監視
  - ログの改ざん防止

SEC-033: 脆弱性管理
  - 依存ライブラリの定期更新
  - セキュリティパッチの適用
  - 脆弱性スキャンの実施 (四半期)

5.5 通信セキュリティ (ISO 27001 A.13)
--------------------------------------

SEC-040: ネットワーク分離
  - 管理ネットワークとの分離
  - ファイアウォール設定
  - 不要ポートの閉鎖

SEC-041: APIセキュリティ
  - 認証トークンの使用
  - レート制限
  - 入力値検証

5.6 インシデント管理 (ISO 27001 A.16)
--------------------------------------

SEC-050: インシデント検知
  - 異常アクセスの検知
  - ログイン失敗の集計
  - 閾値超過時のアラート

SEC-051: インシデント対応
  - インシデント対応手順書
  - エスカレーションフロー
  - 事後レビューの実施

5.7 コンプライアンス (ISO 27001 A.18)
--------------------------------------

SEC-060: 監査証跡
  - 全操作の記録
  - ログの改ざん防止
  - 監査ログの長期保存 (3年間)

SEC-061: 個人情報保護
  - 個人情報の最小化
  - 個人情報へのアクセス制限
  - 削除機能の実装

================================================================================
6. 情報管理要件 (ISO 19650準拠)
================================================================================

6.1 情報管理プロセス (ISO 19650-1/2)
-------------------------------------

INFO-001: 情報コンテナ管理
  - BIM/CADデータのバックアップジョブ分類
  - Work In Progress (WIP) データの識別
  - Shared/Published データの識別
  - Archive データの長期保存管理

INFO-002: 情報セキュリティ分類
  - セキュリティレベルの定義:
    - Public: 公開可能
    - Internal: 社内限定
    - Confidential: 機密
    - Strictly Confidential: 極秘
  - バックアップデータへのセキュリティレベル付与
  - レベルに応じたアクセス制御

INFO-003: 情報交換プロトコル
  - CDE (Common Data Environment) との連携
  - データ受け渡し時の記録
  - 外部組織との情報共有ログ

6.2 データ保持期間 (ISO 19650-3)
---------------------------------

INFO-010: プロジェクトライフサイクル管理
  - プロジェクト進行中: 全バージョン保持
  - プロジェクト完了後: Archive状態で保持
  - 保持期間: 10年間 (建設業法準拠)
  - 廃棄手順の確立

INFO-011: バージョン管理
  - バックアップデータのバージョン記録
  - 主要マイルストーンの識別
  - 復元時のバージョン指定

6.3 情報モデル管理
------------------

INFO-020: メタデータ管理
  - プロジェクトコード
  - 図面番号/モデルID
  - 改訂履歴
  - 作成者/承認者
  - ファイルステータス

INFO-021: 命名規則
  - ISO 19650準拠の命名規則適用
  - バックアップファイル名への反映
  - 検索性の確保

6.4 アセット情報管理 (ISO 19650-3)
-----------------------------------

INFO-030: アセット情報要求 (AIR)
  - 発注者情報要求 (EIR) への対応
  - アセット情報モデル (AIM) のバックアップ
  - 運用・保守情報の長期保存

INFO-031: 構造化情報
  - COBie形式データのバックアップ
  - IFC形式データの保持
  - 属性情報の保全

================================================================================
7. システム制約条件
================================================================================

7.1 技術制約
------------

CONST-001: 開発環境
  - OS: Linux (Ubuntu 22.04/24.04 LTS)
  - Python: 3.10以上
  - Webフレームワーク: Flask 3.0以上
  - データベース: SQLite 3.x (開発) / PostgreSQL 14以上 (本番移行時)

CONST-002: 本番環境
  - OS: Windows 11 Enterprise
  - Python: 3.10以上
  - Webサーバー: Waitress (推奨) または IIS + wfastcgi
  - サービス化: NSSM (Non-Sucking Service Manager)

CONST-003: ブラウザ
  - Google Chrome 100以上
  - Microsoft Edge 100以上
  - Firefox 100以上

7.2 運用制約
------------

CONST-010: メンテナンス時間
  - 月次メンテナンス: 第2土曜日 2:00-4:00
  - 緊急メンテナンス: 営業時間外

CONST-011: バックアップウィンドウ
  - システムバックアップ: 毎日 3:00-4:00
  - 業務時間: 平日 9:00-18:00

7.3 組織制約
------------

CONST-020: 承認プロセス
  - システム変更: ITシステム運用管理者承認
  - セキュリティ変更: 情報セキュリティ管理者承認
  - 本番リリース: 変更諮問委員会 (CAB) 承認

CONST-021: 予算制約
  - ライセンス費用: オープンソースソフトウェアを基本とする
  - 商用ツール連携は最小限
  - クラウドサービス利用は将来検討

7.4 法規制制約
--------------

CONST-030: データ保持
  - 建設業法: 10年間保存
  - 会社法: 10年間保存
  - e-文書法: 電子保存要件準拠

CONST-031: 個人情報保護
  - 個人情報保護法準拠
  - GDPR準拠 (海外子会社がある場合)

================================================================================
8. コンプライアンス要件
================================================================================

8.1 ISO 27001 要求事項マッピング
--------------------------------

COMP-001: A.8 資産管理
  - バックアップ資産の一覧化
  - 資産の責任者明確化
  - 資産の分類と取り扱い

COMP-002: A.9 アクセス制御
  - ユーザーアクセス管理
  - 特権アクセス管理
  - パスワードポリシー

COMP-003: A.12 運用のセキュリティ
  - バックアップ手順の文書化
  - ログ記録と監視
  - 変更管理

COMP-004: A.16 インシデント管理
  - インシデント報告手順
  - 対応記録の保持
  - 教訓の抽出

COMP-005: A.18 コンプライアンス
  - 法的要求事項の遵守
  - 監査証跡の保持
  - 定期的なレビュー

8.2 ISO 19650 要求事項マッピング
--------------------------------

COMP-010: ISO 19650-1 情報管理の概念
  - 情報コンテナの定義
  - 情報ライフサイクル管理
  - セキュリティ配慮

COMP-011: ISO 19650-2 プロジェクトデリバリー
  - 情報要求の定義
  - 情報交換の記録
  - 情報モデルの管理

COMP-012: ISO 19650-3 運用フェーズ
  - アセット情報要求
  - 長期保存計画
  - 廃棄手順

8.3 内部統制要件
----------------

COMP-020: 職務分掌
  - システム管理者とバックアップ運用者の分離
  - 承認権限の明確化
  - 相互牽制の実施

COMP-021: 証跡管理
  - 全操作の記録
  - 改ざん防止
  - 定期的なレビュー

COMP-022: 定期監査
  - 年次内部監査
  - 外部監査対応
  - 改善活動

================================================================================
9. 前提条件と依存関係
================================================================================

9.1 前提条件
------------

ASSUME-001: ネットワーク環境
  - Windows ServerとWindows 11管理端末間のネットワーク接続
  - インターネット接続 (メール送信、パッケージ更新用)
  - ファイアウォール設定の調整権限

ASSUME-002: 既存バックアップシステム
  - Veeam / Windows Server Backup / AOMEI Backupper等が稼働中
  - PowerShellスクリプト実行権限
  - バックアップジョブの情報へのアクセス権限

ASSUME-003: 管理者スキル
  - Python基礎知識
  - PowerShell中級レベル
  - Windows Server管理経験
  - SQL基礎知識

ASSUME-004: インフラ
  - Windows 11マシン (RAM: 8GB以上、HDD: 100GB以上)
  - 固定IPアドレスまたはDNS名
  - SMTPサーバー (メール通知用)

9.2 外部依存関係
----------------

DEP-001: オープンソースライブラリ
  - Flask 3.0
  - SQLAlchemy 2.0
  - APScheduler 3.10
  - Waitress 2.1

DEP-002: バックアップツール
  - Veeam Backup & Replication (任意)
  - Windows Server Backup (任意)
  - AOMEI Backupper (任意)

DEP-003: 外部サービス
  - SMTPサーバー (メール送信)
  - Microsoft Teams (Webhook経由通知)

9.3 移行計画
------------

MIGRATE-001: 段階的導入
  - フェーズ1: パイロット運用 (10ジョブ)
  - フェーズ2: 部門展開 (50ジョブ)
  - フェーズ3: 全社展開 (500ジョブ)

MIGRATE-002: データ移行
  - 既存バックアップジョブの棚卸
  - マスターデータの整備
  - 初期データ投入

================================================================================
10. リスクと課題
================================================================================

10.1 技術リスク
---------------

RISK-001: クロスプラットフォーム互換性
  - リスク: Linux開発環境とWindows本番環境の差異
  - 影響度: 中
  - 対策: pathlib使用、環境変数分離、事前テスト実施
  - 責任者: システム開発チーム

RISK-002: パフォーマンス劣化
  - リスク: ジョブ数増加によるレスポンス低下
  - 影響度: 中
  - 対策: インデックス最適化、ページネーション、キャッシュ導入
  - 責任者: システム管理者

RISK-003: データベース肥大化
  - リスク: ログデータの蓄積による容量逼迫
  - 影響度: 低
  - 対策: ログローテーション、アーカイブ機能
  - 責任者: システム管理者

10.2 運用リスク
---------------

RISK-010: 手動運用の継続
  - リスク: PowerShell連携が進まず手動入力が残る
  - 影響度: 中
  - 対策: API連携の段階的推進、操作マニュアル整備
  - 責任者: バックアップ管理者

RISK-011: オフラインメディア紛失
  - リスク: 物理メディアの紛失・盗難
  - 影響度: 高
  - 対策: 保管場所の厳格管理、バーコード/QRコード管理
  - 責任者: ITシステム運用管理者

RISK-012: 検証テスト未実施
  - リスク: リストアテストの実施遅延
  - 影響度: 高
  - 対策: 自動リマインダー、エスカレーション機能
  - 責任者: バックアップ管理者

10.3 組織リスク
---------------

RISK-020: 人員不足
  - リスク: 担当者の退職・異動
  - 影響度: 中
  - 対策: ドキュメント整備、複数名での運用
  - 責任者: ITシステム運用管理者

RISK-021: 予算不足
  - リスク: ストレージ拡張予算の未確保
  - 影響度: 中
  - 対策: 容量推移の可視化、経営層への早期報告
  - 責任者: ITシステム運用管理者

10.4 セキュリティリスク
-----------------------

RISK-030: 不正アクセス
  - リスク: 外部からの不正アクセス
  - 影響度: 高
  - 対策: ファイアウォール、強固な認証、ログ監視
  - 責任者: 情報セキュリティ管理者

RISK-031: 内部不正
  - リスク: 権限を持つ内部者による不正操作
  - 影響度: 高
  - 対策: 職務分掌、操作ログ記録、定期監査
  - 責任者: 情報セキュリティ管理者

10.5 コンプライアンスリスク
---------------------------

RISK-040: 監査不合格
  - リスク: ISO認証監査での指摘事項
  - 影響度: 高
  - 対策: 内部監査の定期実施、改善活動
  - 責任者: ITシステム運用管理者

RISK-041: 法令違反
  - リスク: データ保持期間違反
  - 影響度: 高
  - 対策: 保持期間の自動チェック、定期レビュー
  - 責任者: ITシステム運用管理者

================================================================================
承認
================================================================================

本要件定義書は、以下の承認を得た上で有効となる。

ITシステム運用管理者: _______________________ 日付: __________

情報セキュリティ管理者: _____________________ 日付: __________

BIM/CIMマネージャー: ________________________ 日付: __________

プロジェクトマネージャー: ___________________ 日付: __________


================================================================================
改訂履歴
================================================================================

版番号  日付         改訂内容                           承認者
------  -----------  ---------------------------------  --------------------
1.0     2025/10/28   初版作成                           [承認者名]


================================================================================
以上
================================================================================
